// Ion.Sound | version 2.0.2 | https://github.com/IonDen/ion.sound
var ion=ion||{};(function(e){var g=function(a){a&&console&&(console.warn&&"function"===typeof console.warn?console.warn(a):console.log&&"function"===typeof console.log&&console.log(a))};if(e.sound)g("ion.sound already exists!");else if("function"!==typeof Audio&&"object"!==typeof Audio){var f=function(){g("HTML5 Audio is not supported in this browser")};e.sound=function(){};e.sound.play=f;e.sound.stop=f;e.sound.destroy=f;f()}else{var d={},b={},k,l,h,c,m=function(a){this.name=a.name;this.volume=d.volume||.5;this.preload=d.preload?"auto":"none";this.paused=this.loop=!1;this.sound=null;"volume"in a&&(this.volume=+a.volume);"preload"in a&&(this.preload=a.preload?"auto":"none")};m.prototype={init:function(){this.sound=new Audio;this.sound.src=d.path+this.name+h;this.sound.load();this.sound.preload=this.preload;this.sound.volume=this.volume;this.sound.addEventListener("ended",this._ended.bind(this),!1)},play:function(a){a||(a={});a.volume&&(this.volume=+a.volume,this.sound.volume=this.volume);a.loop?this.paused?this._playLoop(this.loop+1):this._playLoop(a.loop):(this.loop=!1,this._play())},_play:function(){if(this.paused)this.paused=!1;else try{this.sound.currentTime=0}catch(a){}this.sound.play()},_playLoop:function(a){"boolean"===typeof a?(this.loop=9999999,this._play()):"number"===typeof a&&(this.loop=a-1,this._play())},_ended:function(){0<this.loop&&(this.loop-=1,this._play())},pause:function(){this.paused=!0;this.sound.pause()},stop:function(){this.loop=!1;this.sound.pause();try{this.sound.currentTime=0}catch(a){}},destroy:function(){this.stop();this.sound.removeEventListener("ended",this._ended.bind(this),!1);this.sound.src="";this.sound=null}};e.sound=function(a){d=JSON.parse(JSON.stringify(a));d.path=d.path||"";d.volume=d.volume||.5;d.preload=d.preload||!1;d.mix=d.mix||!0;if(k=d.sounds.length){l=(new Audio).canPlayType("audio/mpeg");switch(l){case "probably":case "maybe":h=".mp3";break;default:h=".ogg"}for(c=0;c<k;c++)a=d.sounds[c],b[a.name]=new m(a),b[a.name].init()}else g("No sound-files provided!")};e.sound.version="2.0.2";e.sound.play=function(a,c){b[a]&&b[a].play(c)};e.sound.pause=function(a){if(a&&b[a])b[a].pause();else for(c in b)b.hasOwnProperty(c)&&b[c]&&b[c].pause()};e.sound.stop=function(a){if(a&&b[a])b[a].stop();else for(c in b)b.hasOwnProperty(c)&&b[c]&&b[c].stop()};e.sound.destroy=function(a){if(a&&b[a])b[a].destroy(),b[a]=null;else for(c in b)b.hasOwnProperty(c)&&b[c]&&(b[c].destroy(),b[c]=null)}}})(ion);
